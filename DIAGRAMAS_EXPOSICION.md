# ๐ Diagramas para Exposiciรณn - PlantCare AI

## ๐จ DIAGRAMA 1: Arquitectura General

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    PLANTCARE AI SYSTEM                        โ
โ          Arquitectura Multi-Agente con LangChain               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

                    โโโโโโโโโโโโโโโโโโโ
                    โ   USUARIO       โ
                    โ  [Imagen + Texto]โ
                    โโโโโโโโโโฌโโโโโโโโโ
                             โ
                             โผ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
        โ   RESPONSE AGENT (Orquestador)            โ
        โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
        โ   โ  LangChain AgentExecutor         โ   โ
        โ   โ  - Coordina agentes              โ   โ
        โ   โ  - Gestiona flujo                โ   โ
        โ   โ  - Genera respuesta final         โ   โ
        โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ   โ
        โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                    โ
        โโโโโโโโโโโโโผโโโโโโโโโโโโฌโโโโโโโโโโโโ
        โ           โ           โ           โ
        โผ           โผ           โผ           โผ
    โโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโ โโโโโโโโโโโโ
    โ VISION โ โKNOWLEDGE โ โANALYSISโ โ   LLM    โ
    โ AGENT  โ โ  AGENT   โ โ AGENT  โ โ (Gemini) โ
    โโโโโฌโโโโโ โโโโโโฌโโโโโโ โโโโโฌโโโโโ โโโโโโฌโโโโโโ
        โ           โ           โ           โ
        โผ           โผ           โผ           โผ
    โโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโ โโโโโโโโโโโโ
    โPlant.idโ โ SUPABASE โ โ Reglasโ โGeneraciรณnโ
    โGemini  โ โ pgvector โ โ Lรณgicaโ โ Respuestaโ
    โVision  โ โEmbeddingsโ โ        โ โ          โ
    โโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโ โโโโโโโโโโโโ
```

---

## ๐ DIAGRAMA 2: Flujo de Datos Detallado

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    FLUJO DE PROCESAMIENTO                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

1. ENTRADA
   โโโโโโโโโโโโโโโโ
   โ Imagen Plantaโ
   โ + Pregunta   โ
   โโโโโโโโฌโโโโโโโโ
          โ
          โผ
2. AGENTE DE VISIรN
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ โข Plant.id API โ Identifica especie โ
   โ โข Gemini Vision โ Analiza salud     โ
   โ โข Detecta problemas visuales        โ
   โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
                  โผ
   Resultado: {especie, salud, problemas}
                  โ
                  โผ
3. AGENTE DE CONOCIMIENTO
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ โข Genera embedding de consulta      โ
   โ โข Busca en Supabase (pgvector)      โ
   โ โข Retorna top 5 documentos          โ
   โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
                  โผ
   Resultado: {documentos relevantes}
                  โ
                  โผ
4. AGENTE DE ANรLISIS
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ โข Combina: visiรณn + conocimiento   โ
   โ โข Aplica reglas de diagnรณstico     โ
   โ โข Calcula puntuaciรณn de salud       โ
   โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
                  โผ
   Resultado: {diagnรณstico, score, issues}
                  โ
                  โผ
5. LLM (Generaciรณn)
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ โข Recibe: anรกlisis completo         โ
   โ โข Genera recomendaciones           โ
   โ โข Formatea respuesta final          โ
   โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโ
                  โ
                  โผ
6. SALIDA
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   โ โข Especie identificada              โ
   โ โข Estado de salud                   โ
   โ โข Diagnรณstico                       โ
   โ โข Recomendaciones personalizadas    โ
   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ง DIAGRAMA 3: Embeddings y Bรบsqueda Vectorial

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           EMBEDDINGS Y BรSQUEDA VECTORIAL                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

TEXTO PLANA                    EMBEDDING (Vector)
โโโโโโโโโโโโโโโโ              โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ"ยฟCรณmo cuido  โ   โโโโโโโโ>  โ [0.23, -0.45, 0.12,     โ
โ una          โ   sentence-  โ  0.67, -0.23, 0.89,     โ
โ suculenta?"  โ   transformersโ  ... (384 nรบmeros)     โ
โโโโโโโโโโโโโโโโ              โโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                                        โ
                                        โผ
                            โโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ   SUPABASE            โ
                            โ   โโโโโโโโโโโโโโโโโโโ โ
                            โ   โ plant_documents โ โ
                            โ   โ - text          โ โ
                            โ   โ - embedding     โ โ
                            โ   โ   (vector 384)  โ โ
                            โ   โโโโโโโโโโโโโโโโโโโ โ
                            โ                       โ
                            โ   Bรบsqueda con        โ
                            โ   pgvector            โ
                            โ   (similitud coseno)  โ
                            โโโโโโโโโโโโโฌโโโโโโโโโโโโ
                                        โ
                                        โผ
                            โโโโโโโโโโโโโโโโโโโโโโโโโ
                            โ Top 5 Documentos      โ
                            โ Mรกs Relevantes        โ
                            โ (ordenados por        โ
                            โ  similitud)           โ
                            โโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ DIAGRAMA 4: LangChain AgentExecutor

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              LANGCHAIN AGENTEXECUTOR                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

                    โโโโโโโโโโโโโโโโโโโโ
                    โ  AgentExecutor   โ
                    โ  (Orquestador)   โ
                    โโโโโโโโโโฌโโโโโโโโโโ
                             โ
                โโโโโโโโโโโโโโผโโโโโโโโโโโโโ
                โ            โ            โ
                โผ            โผ            โผ
        โโโโโโโโโโโโ  โโโโโโโโโโโโ  โโโโโโโโโโโโ
        โ  Tool 1  โ  โ  Tool 2  โ  โ  Tool 3  โ
        โ  Vision  โ  โ Knowledgeโ  โ Analysis โ
        โโโโโโฌโโโโโโ  โโโโโโฌโโโโโโ  โโโโโโฌโโโโโโ
             โ             โ             โ
             โผ             โผ             โผ
        โโโโโโโโโโ    โโโโโโโโโโ    โโโโโโโโโโ
        โVision  โ    โSupabaseโ    โReglas  โ
        โAgent   โ    โSearch  โ    โLogic   โ
        โโโโโโโโโโ    โโโโโโโโโโ    โโโโโโโโโโ
             โ             โ             โ
             โโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ
                           โ
                           โผ
                    โโโโโโโโโโโโโโโโ
                    โ  LLM (Gemini)โ
                    โ  Genera      โ
                    โ  Respuesta   โ
                    โโโโโโโโโโโโโโโโ
```

---

## ๐ฆ DIAGRAMA 5: Estructura de Datos

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ESTRUCTURA DE DATOS                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SUPABASE (PostgreSQL + pgvector)
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  TABLE: plant_documents                     โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โ id          BIGSERIAL                 โ โ
โ  โ chunk_id    TEXT                      โ โ
โ  โ text        TEXT                      โ โ
โ  โ embedding   vector(384)  โ pgvector   โ โ
โ  โ source_file TEXT                      โ โ
โ  โ created_at  TIMESTAMP                 โ โ
โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ                                             โ
โ  Funciรณn: match_plant_documents()           โ
โ  โข Recibe: query_embedding (vector)        โ
โ  โข Busca: documentos similares             โ
โ  โข Retorna: top N documentos               โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

EJEMPLO DE DOCUMENTO:
{
  "text": "Las suculentas requieren riego moderado...",
  "embedding": [0.23, -0.45, 0.12, ...],
  "source_file": "cuidado_suculentas.txt"
}
```

---

## ๐ DIAGRAMA 6: Fallbacks del Sistema

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    SISTEMA DE FALLBACKS                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

IDENTIFICACIรN DE PLANTA:
    Plant.id API
         โ
         โโ> โ รxito โ Usar resultado
         โ
         โโ> โ Falla โ Gemini Vision (fallback)

GENERACIรN DE RESPUESTAS:
    Gemini LLM
         โ
         โโ> โ Disponible โ Usar Gemini
         โ
         โโ> โ No disponible โ Ollama (local)
                  โ
                  โโ> โ Disponible โ Usar Ollama
                  โ
                  โโ> โ No disponible โ Documentos + Demo Mode

ANรLISIS DE IMรGENES:
    Gemini Vision
         โ
         โโ> โ Disponible โ Analizar imagen
         โ
         โโ> โ No disponible โ Deshabilitar funciรณn
                                    โ
                                    โโ> Mensaje al usuario
```

---

## ๐ป DIAGRAMA 7: Cรณdigo Clave - Flujo Principal

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              CรDIGO: FLUJO PRINCIPAL                        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

# main.py - Endpoint principal
@app.post("/api/analyze-plant")
async def analyze_plant(image, user_actions):
    # 1. Guardar imagen temporal
    temp_file = save_image(image)
    
    # 2. Ejecutar sistema multi-agente
    result = response_agent.execute(
        image_path=temp_file,
        user_actions=user_actions
    )
    
    return result

# agente_respuesta.py - Orquestaciรณn
def execute(self, image_path, user_actions):
    # 1. Vision Agent
    vision_result = self.vision_agent.execute(image_path)
    
    # 2. Knowledge Agent
    knowledge_result = self.knowledge_agent.execute(
        vision_result, user_actions
    )
    
    # 3. Analysis Agent
    analysis_result = self.analysis_agent.execute(
        vision_result, knowledge_result, user_actions
    )
    
    # 4. Generar recomendaciones con LLM
    recommendations = self.generate_recommendations(
        analysis_result, knowledge_result['context']
    )
    
    return final_response
```

---

## ๐ฏ DIAGRAMA 8: Comparaciรณn: Con vs Sin LangChain

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ         CON LANGCHAIN vs SIN LANGCHAIN                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

SIN LANGCHAIN (Implementaciรณn Manual):
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ response_agent.execute()            โ
โ   โโ> vision_agent.execute()        โ
โ   โโ> knowledge_agent.execute()     โ
โ   โโ> analysis_agent.execute()      โ
โ   โโ> generate_recommendations()    โ
โ                                      โ
โ Control manual del flujo            โ
โ Orquestaciรณn explรญcita              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

CON LANGCHAIN (AgentExecutor):
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ AgentExecutor                        โ
โ   โโ> Tool: vision_analysis          โ
โ   โโ> Tool: knowledge_search         โ
โ   โโ> Tool: plant_analysis          โ
โ   โโ> LLM decide quรฉ tool usar      โ
โ                                      โ
โ Flujo inteligente y dinรกmico        โ
โ El LLM decide el orden              โ
โ Memoria de conversaciรณn             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## ๐ MรTRICAS Y RESULTADOS

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    RESULTADOS DEL SISTEMA                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

โ IDENTIFICACIรN DE PLANTAS
   โข Plant.id API: ~85% precisiรณn
   โข Gemini Vision: ~70% precisiรณn (fallback)

โ BรSQUEDA VECTORIAL
   โข Embeddings: 384 dimensiones
   โข Tiempo de bรบsqueda: <100ms
   โข Precisiรณn: Top 5 documentos relevantes

โ DIAGNรSTICO
   โข Detecta: exceso/falta de riego, problemas de luz
   โข Puntuaciรณn de salud: 1-10
   โข Precisiรณn: ~80% en problemas comunes

โ RECOMENDACIONES
   โข Generadas por LLM (Gemini/Ollama)
   โข Personalizadas segรบn anรกlisis
   โข Basadas en conocimiento de Supabase
```

---

## ๐ CONCEPTOS CLAVE (Para Explicar)

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    CONCEPTOS TรCNICOS                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ

EMBEDDING:
  Texto โ Vector numรฉrico que captura significado
  Ejemplo: "suculenta" โ [0.23, -0.45, 0.12, ...]

SIMILITUD DEL COSENO:
  Compara dos vectores para medir similitud
  Rango: -1 (opuesto) a 1 (idรฉntico)

PGVECTOR:
  Extensiรณn de PostgreSQL para bรบsqueda vectorial
  Permite bรบsquedas eficientes en millones de vectores

LANGCHAIN:
  Framework para construir aplicaciones con LLMs
  Facilita orquestaciรณn de agentes y herramientas

AGENTEXECUTOR:
  Coordina ejecuciรณn de agentes
  Decide quรฉ herramienta usar y cuรกndo

RAG (Retrieval-Augmented Generation):
  Busca informaciรณn relevante antes de generar respuesta
  Mejora precisiรณn y reduce alucinaciones
```

---

**Usa estos diagramas durante la exposiciรณn para visualizar los conceptos clave! ๐**

